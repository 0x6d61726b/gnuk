<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ChibiOS/RT: How to manage memory</title>
<link href="custom.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<table style="text-align: center; width: 100%;" border="0"
 cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td style="width: 80px;"><img alt="ChibiOS/RT Logo" src="logo_small.png"></td>
      <td><big><big>ChibiOS/RT</big></big><br><br>Architecture - Reference Manual - Guides</td>
      <td style="width: 80px;"></td>
    </tr>
  </tbody>
</table>
<hr size="1">
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="main.html">ChibiOS/RT</a>      </li>
      <li><a class="el" href="articles.html">Articles and Code Samples</a>      </li>
      <li><a class="el" href="page_howtos.html">How To's</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>How to manage memory </h1>  </div>
</div>
<div class="contents">
<p>ChibiOS/RT is a static kernel so you don't need to manage memory at all if your application doesn't really require it. This doesn't mean that the OS is unable to manage memory but just that memory management is an optional part of the whole.<br/>
 The OS offers three distinct ways to manage memory, each one with its weaknesses and strengths:</p>
<ul>
<li>Core Memory Manager. See <a class="el" href="group__memcore.html">Core Memory Manager</a>.</li>
<li>Heap Allocator. See <a class="el" href="group__heaps.html">Heaps</a>.</li>
<li>Memory Pools. See <a class="el" href="group__pools.html">Memory Pools</a>.</li>
</ul>
<p>The three mechanisms are able to coexist and are well integrated, as example the heap allocator uses the core memory manager in order to get more memory blocks, memory pools can optionally do the same thing.</p>
<h2>The three subsystems</h2>
<p>This is a small comparison table regarding the three subsystems, C-runtime and static objects are thrown in there for comparison:<br/>
<br/>
 </p>
<table  style="text-align: center; width: 95%;" align="center" border="1" cellpadding="2" cellspacing="0">
<tr>
<th style="width: 100px; background-color: rgb(192, 192, 192);"><small>Subsystem</small>  </th><th style="width: 80px; background-color: rgb(192, 192, 192);"><small>Free capable</small>  </th><th style="width: 80px; background-color: rgb(192, 192, 192);"><small>Constant time</small>  </th><th style="width: 80px; background-color: rgb(192, 192, 192);"><small>Safe</small>  </th><th style="width: 80px; background-color: rgb(192, 192, 192);"><small>From IRQ</small>  </th><th style="background-color: rgb(192, 192, 192);"><small>Notes</small>   </th></tr>
<tr>
<th style="background-color: rgb(224, 224, 224);"><small>Static Objects</small>  </th><td><small>N/A</small> </td><td><small>N/A</small> </td><td><small>YES</small> </td><td><small>YES</small> </td><td style="text-align: left;">Preferred solution for safety applications.   </td></tr>
<tr>
<th style="background-color: rgb(224, 224, 224);"><small>Core Memory Manager</small>  </th><td><small>NO</small> </td><td><small>YES</small> </td><td><small>YES</small> </td><td><small>YES</small> </td><td style="text-align: left;">Fast and safe but unable to free allocated memory.   </td></tr>
<tr>
<th style="background-color: rgb(224, 224, 224);"><small>Heap Allocator</small>  </th><td><small>YES</small> </td><td><small>NO</small> </td><td><small>NO</small> </td><td><small>NO</small> </td><td style="text-align: left;">Unsafe because fragmentation and not constant time, cannot be used from IRQ handlers.   </td></tr>
<tr>
<th style="background-color: rgb(224, 224, 224);"><small>Memory Pools</small>  </th><td><small>YES</small> </td><td><small>YES</small> </td><td><small>YES</small> </td><td><small>YES</small> </td><td style="text-align: left;">Fast and safe but it can handle fixed size objects only, you may have multiple memory pools however.   </td></tr>
<tr>
<th style="background-color: rgb(224, 224, 224);"><small>C-Runtime</small>  </th><td><small>YES</small> </td><td><small>NO</small> </td><td><small>NO</small> </td><td><small>NO</small> </td><td style="text-align: left;">Unsafe because fragmentation, not constant time, cannot be used from IRQ handlers and not thread safe. The C runtime must also be modified in order to work with the other allocators.   </td></tr>
</table>
<p><br/>
 When designing a system it is recommended to proceed as follow:</p>
<ol type="1">
<li>Use static objects and initializers whenever possible.</li>
<li>Where dynamic allocation is required without have to free the allocated memory then use the Core Memory Manager allocation APIs.</li>
<li>Where dynamic allocation is required evaluate if one or more memory pools can be used.</li>
<li>If all the above points do not satisfy your requirements then use the heap allocator.</li>
<li>Consider the C-runtime allocator only for legacy code.</li>
</ol>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Sun Oct 24 2010 09:40:45 for ChibiOS/RT by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.7.1</small></address>
</body>
</html>
